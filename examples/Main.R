## -------------------------------------------------------------------------------------------------------------------------------------------------------------
library(QuantileTools)

## -------------------------------------------------------------------------------------------------------------------------------------------------------------
date <- seq(as.Date("1990/1/1"), by = "days", length.out = 100)

# Extract variables
ER_log <- ts(rnorm(100))
EPU_log <- ts(rnorm(100))
TRD_log <- ts(rnorm(100))
OP_log <- ts(rnorm(100))

# Quantiles of interest
taus <- seq(0.1, 0.9, 0.1)

### Plots
## -------------------------------------------------------------------------------------------------------------------------------------------------------------
# Plot the data
ts_plot_ly(ER_log, date)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ts_plot_ly(EPU_log, date)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ts_plot_ly(OP_log, date)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ts_plot_ly(TRD_log, date)

### QADF
## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ER_adf <- QADF(ER_log, taus, 7)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
EPU_adf <- QADF(EPU_log, taus, 7)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
OP_adf <- QADF(OP_log, taus, 7)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
TRD_adf <- QADF(TRD_log, taus, 7)


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ADF_results <- Reduce(function(x, y) merge(x, y, by = "Quantile"), 
                      list(ER_adf, EPU_adf, OP_adf, TRD_adf))
colnames(ADF_results) <- c("Quantiles", "ER", "EPU", "OP", "TRD")
ADF_results


### Granger
## -------------------------------------------------------------------------------------------------------------------------------------------------------------
ER_EPU_Granger <- QGranger(ER_log, EPU_log, 3, taus)
ER_EPU_Granger


### QECM
## -------------------------------------------------------------------------------------------------------------------------------------------------------------
QECM_TRD <- QECM(ER_log, EPU_log, TRD_log, 3, 3, 3, taus)
QECM_TRD

## -------------------------------------------------------------------------------------------------------------------------------------------------------------
QECM_OP <- QECM(ER_log, EPU_log, OP_log, 3, 3, 3, taus)
QECM_OP


### QQ
## -------------------------------------------------------------------------------------------------------------------------------------------------------------
QQ_EPU <- QQRegression(ER_log, EPU_log, taus, taus)
QQplot(QQ_EPU) %>%
  layout(scene = list(
    xaxis = list(title = "ER_log"),
    yaxis = list(title = "EPU_log"),
    zaxis = list(title = "Beta")))


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
QQ_TRD <- QQRegression(ER_log, TRD_log, taus, taus)
QQplot(QQ_TRD) %>%
  layout(scene = list(
    xaxis = list(title = "ER_log"),
    yaxis = list(title = "TRD_log"),
    zaxis = list(title = "Beta")))


## -------------------------------------------------------------------------------------------------------------------------------------------------------------
QQ_OP <- QQRegression(ER_log, OP_log, taus, taus)
QQplot(QQ_OP) %>%
    layout(scene = list(
    xaxis = list(title = "ER_log"),
    yaxis = list(title = "OP_log"),
    zaxis = list(title = "Beta")))

